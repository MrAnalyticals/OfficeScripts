{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook, jsonInput: string): string {\n  // Define types\n  type TextBlock = {\n    type: string;\n    text: string;\n    weight: string;\n    wrap: boolean;\n    size: string;\n  };\n\n  type TableCell = {\n    type: string;\n    items: TextBlock[];\n  };\n\n  type TableRow = {\n    type: string;\n    cells: TableCell[];\n  };\n\n  // Parse JSON input\n  const jsonData: TableRow[] = JSON.parse(jsonInput);\n\n  // Extract headers from the first row\n  const headerRow = jsonData[0];\n  const headers: string[] = headerRow.cells.map(cell => {\n    const textBlock = cell.items.find(item => item.type === \"TextBlock\");\n    return textBlock?.text || \"\";\n  });\n\n  // Markdown header and divider\n  const markdownHeader = `| ${headers.join(\" | \")} |`;\n  const markdownDivider = `| ${headers.map(() => \"---\").join(\" | \")} |`;\n\n  // Extract data rows\n  const dataRows = jsonData.slice(1); // skip header\n  const markdownData = dataRows.map(row => {\n    const values = row.cells.map(cell => {\n      const textBlock = cell.items.find(item => item.type === \"TextBlock\");\n      return textBlock?.text || \"\";\n    });\n    return `| ${values.join(\" | \")} |`;\n  });\n\n  // Combine all parts\n  const markdownTable = [markdownHeader, markdownDivider, ...markdownData].join(\"\\n\");\n\n  // Return to Power Automate\n  return markdownTable;\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"jsonInput\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"jsonInput\"],\"properties\":{\"jsonInput\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"jsonInput\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}