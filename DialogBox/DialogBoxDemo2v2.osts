{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\n  let selectedSheet = workbook.getWorksheet('DialogBoxDemo2');\n  let chartSheet = workbook.getWorksheet('SalesInvoicesChart');  \n  //Insert this at the top of your main function\n  let dialogMsgStr:string //declare the dialog message\n  let cellReference:string //use a single cell reference\n  let invoiceSentTableRowCount = selectedSheet.getTable(\"Table1\").getColumnByName(\"Country\").getRangeBetweenHeaderAndTotal().getRowCount()\n  if (invoiceSentTableRowCount > 0){\n      //create the chart on sheet DialogBoxDemo2\n    let ChartObj1 = chartSheet.getCharts()[0]\n    let chartImage = ChartObj1.getImage()\n    let chartImageShape = selectedSheet.addImage(chartImage)\n    chartImageShape.setLeft(0);\n    chartImageShape.setTop(198.75);\n    chartImageShape.setWidth(369);\n    chartImageShape.setHeight(225);\n\n    dialogMsgStr = \"Invoice Table Chart Created successfully. There was more than zero invoices this month!\"\n    cellReference = 'C2'\n    DisplayDialog(workbook, dialogMsgStr, cellReference)\n}\n\nelse{\n    dialogMsgStr = \"Invoice Table Chart Was not Created. There were no invoices this month!\"\n    cellReference = 'C2'\n    DisplayDialog(workbook, dialogMsgStr, cellReference)\n}}  \n\nfunction CleardataVal(workbook: ExcelScript.Workbook,cellRefs:string) {\n  // Get the data validation object for C2:C2 in the current worksheet.\n  let selectedSheet1 = workbook.getWorksheet('DialogBoxDemo2');\n  let dataValidation = selectedSheet1.getRange(cellRefs + \":\"+ cellRefs).getDataValidation();\n  // Clear any previous validation to avoid conflicts.\n  dataValidation.clear();\n  selectedSheet1.getCell(1, 2).setValue(null)\n  selectedSheet1.getCell(2, 2).select()\n}\n\nfunction DisplayDialog(workbook: ExcelScript.Workbook,dialogMsg:string,cellRef:string) {\n  // Get the data validation object for C2:C2 in the current worksheet.\n  let selectedSheet1 = workbook.getWorksheet('DialogBoxDemo2');\n  let dataValidation = selectedSheet1.getRange(cellRef + \":\" + cellRef).getDataValidation();\n  // Clear any previous validation to avoid conflicts.\n  dataValidation.clear()\n  const prompt: ExcelScript.DataValidationPrompt = {\n    showPrompt: true,\n    title: \"DialogBoxDemo2 Message\",\n    message: dialogMsg\n  }\n  dataValidation.setPrompt(prompt)\n  selectedSheet1.getCell(1, 2).setValue(1)\n  selectedSheet1.getCell(1, 2).select()// clear()//.showCard()\n  CleardataVal(workbook,\"c2\")\n  sleepy(5)\n}\n\n\nfunction sleepy(seconds: number): void {\n  const waitUntil: number = new Date().getTime() + seconds * 1000;\n  while (new Date().getTime() < waitUntil) { }\n}","description":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}