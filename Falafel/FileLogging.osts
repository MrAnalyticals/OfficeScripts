{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook, Filename_with_extension: string, Modified: string, Modified_by_DisplayName: string, Created: string, Created_by_DisplayName: string,UniqueIdentifier:string, Link_to_item: string, FolderPath:string,VersionNumber:string) {\n/*\n  Filename_with_extension = \"BookRenamed14.xlsx\"\n  Modified = \"2023-01-14T17:48:25Z\"\n  Modified_by_DisplayName = \"Analysis Cloud Ltd\"\n  Created = \"2022-12-25T12:10:55Z\" \n  Created_by_DisplayName =\"Analysis Cloud Ltd\"\n  UniqueIdentifier = \"wec1b149f1384494c81323c503a7afa81\" //bookrenamed file\n  Link_to_item = \"https://analysisie.sharepoint.com/sites/PowerFlowTesting/DocLib1/Folder1/BookRenamed14.xlsx?d=wec1b149f1384494c81323c503a7afa81\"\n  FolderPath = \"DocLib1/Folder1/\"\n  VersionNumber = \"27\"\n*/\n  //wec1b149f1384494c81323c503a7afa81\thttps://analysisie.sharepoint.com/sites/PowerFlowTesting/DocLib1/Folder1/BookRenamed14.xlsx?d=wec1b149f1384494c81323c503a7afa81\tBookRenamed14.xlsx\t2023-01-14T17:48:25Z\tAnalysis Cloud Ltd\t2022-12-25T12:10:55Z\tAnalysis Cloud Ltd2\tDocLib1/Folder1/\t26\n\n\n//Script logic: Find existing file name. If false create a new record.\n//If true update existing record.\nlet FileLog = workbook.getWorksheet('FileLog')\nlet FileLogTable = workbook.getTable('TblFileLog')\n//Use Match function to ascertain the matching row number.\nFileLog.getCell(2, 11).setFormula('=MATCH(\"' + UniqueIdentifier + '\",TblFileLog[Identifier],0)')\n\nif(FileLog.getCell(2,11).getValue().toString()=='#N/A'){\n  console.log(\"Adding a new record at the end of the table.\")\n  FileLogTable.addRow(-1, [UniqueIdentifier, Link_to_item, Filename_with_extension, Modified, Modified_by_DisplayName, Created, Created_by_DisplayName, FolderPath, VersionNumber])\n  console.log(\"UniqueIdentifier, Link_to_item, Filename_with_extension, Modified, Modified_by_DisplayName, Created, Created_by_DisplayName, FolderPath, VersionNumber:\" + UniqueIdentifier, Link_to_item, Filename_with_extension, Modified, Modified_by_DisplayName, Created, Created_by_DisplayName, FolderPath, VersionNumber)\n}\nelse if (parseInt(FileLog.getCell(2, 11).getValue().toString())>0) {\n  //Update record at row \nlet rowNumber = parseInt(FileLog.getCell(2, 11).getValue().toString())+2\n  console.log(\"Editing an existing record at rowNumber: \"+ rowNumber)\n  FileLog.getRange(\"a\" + rowNumber + \":i\" + rowNumber).setValues([[UniqueIdentifier,Link_to_item, Filename_with_extension,Modified,Modified_by_DisplayName,Created,Created_by_DisplayName,FolderPath,VersionNumber]])\n  console.log(\"UniqueIdentifier, Link_to_item, Filename_with_extension, Modified, Modified_by_DisplayName, Created, Created_by_DisplayName, FolderPath, VersionNumber:\" + UniqueIdentifier, Link_to_item, Filename_with_extension, Modified, Modified_by_DisplayName, Created, Created_by_DisplayName, FolderPath, VersionNumber)\n}\nlet TableRowCount= FileLogTable.getRowCount()\n//Adjust row height\n  FileLog.getRange(\"2:\" + (TableRowCount+2)).getExtendedRange(ExcelScript.KeyboardDirection.down).getFormat().setRowHeight(35)\n}\n","description":"","parameterInfo":"{\"originalParameterOrder\":[{\"name\":\"Filename_with_extension\",\"index\":0},{\"name\":\"Modified\",\"index\":1},{\"name\":\"Modified_by_DisplayName\",\"index\":2},{\"name\":\"Created\",\"index\":3},{\"name\":\"Created_by_DisplayName\",\"index\":4},{\"name\":\"UniqueIdentifier\",\"index\":5},{\"name\":\"Link_to_item\",\"index\":6},{\"name\":\"FolderPath\",\"index\":7},{\"name\":\"VersionNumber\",\"index\":8}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"Filename_with_extension\",\"Modified\",\"Modified_by_DisplayName\",\"Created\",\"Created_by_DisplayName\",\"UniqueIdentifier\",\"Link_to_item\",\"FolderPath\",\"VersionNumber\"],\"properties\":{\"Filename_with_extension\":{\"type\":\"string\"},\"Modified\":{\"type\":\"string\"},\"Modified_by_DisplayName\":{\"type\":\"string\"},\"Created\":{\"type\":\"string\"},\"Created_by_DisplayName\":{\"type\":\"string\"},\"UniqueIdentifier\":{\"type\":\"string\"},\"Link_to_item\":{\"type\":\"string\"},\"FolderPath\":{\"type\":\"string\"},\"VersionNumber\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}